<?phpinclude 'Telegram.php';include 'User.php';include 'Districts.php';include 'TrainingCentres.php';include 'Subjects.php';// Set the bot TOKEN$bot_token = '990123851:AAHKpJUt2w8PkCL8Q7iUVDSq2tf71n2Atjw';// Instances the class$telegram = new Telegram($bot_token);$text = $telegram->Text();$chatID = $telegram->ChatID();$callback_query = $telegram->Callback_Query();if ($chatID == null) {    $chatID = 635793263;}// Instances the class$user = new User($chatID);$districts = new Districts($user->getLanguage());$trainingCentres = new TrainingCentres();$subjects = new Subjects($user->getLanguage());echo 'vse norm';echo "<br />";if ($callback_query !== null && $callback_query != '') {    $callback_data = $telegram->Callback_Data();    $chatID = $telegram->Callback_ChatID();    //save language    switch ($callback_data) {        case 'ru':        case 'uz':            $user->setLanguage($callback_data);            //send answer to callback            showMainPage();            break;    }    //answer nothing with answerCallbackQuery, because it is required    $content = ['callback_query_id' => $telegram->Callback_ID(), 'text' => '', 'show_alert' => false];    $telegram->answerCallbackQuery($content);}if ($text == '/start' || $text == $user->getText('btn_change_lang')) {    sendChangeLangInlineKeyboard();} elseif (substr($text, 5) == $user->getText('btn_main1')) {    $user->setStep("districts");    sendDistricts();} elseif (substr($text, 5) == $user->getText('btn_main2')) {    sendAllTrainingCentresList();} elseif (substr($text, 5) == $user->getText('btn_main_page')) {    showMainPage();} elseif (substr($text, 5) == $user->getText('btn_back')) {    switch ($user->getStep()) {        case "districts":            showMainPage();            break;    }} elseif ($user->getStep() == "districts") {    if ((strpos($text, "ğŸ“") !== false) && ((strpos($text, "tuman") !== false) || ((strpos($text, "Ñ€Ğ°Ğ¹Ğ¾Ğ½") !== false)))) {        $user->setStep("subjects");        $msubjects = $subjects->getAllSubjects();        for ($i = 0; $i < count($msubjects); $i++) {            $msubjects[$i] = "â–«ï¸ " . $msubjects[$i];        }        msendKeyBoard($msubjects, $user->getText("text_choose_subject")." ğŸ‘‡ğŸ»");    }} elseif ($user->getStep() == "subjects") {//        $districtsName = substr($text, 5);//        $district = $districts->getKeywordByName($districtsName);//        $tcList = [];//        foreach ($trainingCentres->getNames() as $name) {//            if ($trainingCentres->getDistrict($name) == $district) {//                $tcList [] = $name;//            }//        }////        sendTrainingCentresList($tcList);}function showMainPage(){    global $user;    $user->setStep("main_page");    $buttons = ["ğŸ”– " . $user->getText('btn_main1'), "ğŸ’ " . $user->getText('btn_main2')];    msendKeyBoard($buttons, $user->getText('text_main') . " ğŸ‘‡ğŸ»");}function msendKeyBoard($buttons, $text){    global $user;    global $telegram;    $option = [];    if (count($buttons) % 2 == 0) {        for ($i = 0; $i < count($buttons); $i += 2) {            $option[] = array($telegram->buildKeyboardButton($buttons[$i]), $telegram->buildKeyboardButton($buttons[$i + 1]));        }    } else {        for ($i = 0; $i < count($buttons) - 1; $i += 2) {            $option[] = array($telegram->buildKeyboardButton($buttons[$i]), $telegram->buildKeyboardButton($buttons[$i + 1]));        }        $option[] = array($telegram->buildKeyboardButton(end($buttons)));    }    if ($user->getStep() == "main_page") {        $option[] = array($telegram->buildKeyboardButton($user->getText("btn_change_lang")));    } else {        $option[] = array($telegram->buildKeyboardButton("ğŸ”™ " . $user->getText('btn_back')), $telegram->buildKeyboardButton("ğŸ”™ " . $user->getText('btn_main_page')));    }    $keyb = $telegram->buildKeyBoard($option, $onetime = false, $resize = true);    $content = array('chat_id' => $telegram->ChatID(), 'reply_markup' => $keyb, 'text' => $text);    $telegram->sendMessage($content);}function sendAllTrainingCentresList(){    global $telegram, $trainingCentres;    $text = "Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ÑƒÑ‡ĞµĞ±Ğ½Ñ‹Ğµ Ñ†ĞµĞ½Ñ‚Ñ€Ñ‹" . " ğŸ‘‡ğŸ»";    $buttons = $callback_dates = $trainingCentres->getNames();    $option = array();    if (count($buttons) <= 5) {        for ($i = 0; $i < count($buttons); $i++) {            $option[] = array($telegram->buildInlineKeyBoardButton("â˜‘ï¸" . $buttons[$i] . "â˜‘ï¸", $url = '', $callback_data = $callback_dates[$i]));        }    } else {        for ($i = 0; $i < 5; $i++) {            $option[] = array($telegram->buildInlineKeyBoardButton("â˜‘ï¸" . $buttons[$i] . "â˜‘ï¸", $url = '', $callback_data = $callback_dates[$i]));            $option[] = array($telegram->buildInlineKeyBoardButton("â¬…ï¸", $url = '', $callback_data = 'back'), $telegram->buildInlineKeyBoardButton("â¡ï¸", $url = '', $callback_data = 'forward'));        }    }    $keyb = $telegram->buildInlineKeyBoard($option);    $content = array('chat_id' => $telegram->ChatID(), 'reply_markup' => $keyb, 'text' => $text);    $telegram->sendMessage($content);}function sendTrainingCentresList($buttons){    global $telegram;    if ($buttons !== []) {        $text = "Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ÑƒÑ‡ĞµĞ±Ğ½Ñ‹Ğµ Ñ†ĞµĞ½Ñ‚Ñ€Ñ‹" . " ğŸ‘‡ğŸ»";        $callback_dates = $buttons;        $option = array();        if (count($buttons) <= 5) {            for ($i = 0; $i < count($buttons); $i++) {                $option[] = array($telegram->buildInlineKeyBoardButton("â˜‘ï¸" . $buttons[$i] . "â˜‘ï¸", $url = '', $callback_data = $callback_dates[$i]));            }        } else {            for ($i = 0; $i < 5; $i++) {                $option[] = array($telegram->buildInlineKeyBoardButton("â˜‘ï¸" . $buttons[$i] . "â˜‘ï¸", $url = '', $callback_data = $callback_dates[$i]));                $option[] = array($telegram->buildInlineKeyBoardButton("â¬…ï¸", $url = '', $callback_data = 'back'), $telegram->buildInlineKeyBoardButton("â¡ï¸", $url = '', $callback_data = 'forward'));            }        }        $keyb = $telegram->buildInlineKeyBoard($option);        $content = array('chat_id' => $telegram->ChatID(), 'reply_markup' => $keyb, 'text' => $text);        $telegram->sendMessage($content);    } else {        $content = array('chat_id' => $telegram->ChatID(), 'text' => "ĞĞµÑ‚ ÑƒÑ‡ĞµĞ±Ğ½Ñ‹Ñ… Ñ†ĞµĞ½Ñ‚Ñ€Ğ¾Ğ² Ğ² ÑÑ‚Ğ¾Ğ¼ Ñ‚ÑƒĞ¼Ğ°Ğ½Ğµ ğŸ˜”");        $telegram->sendMessage($content);    }}function sendChangeLangInlineKeyboard(){    global $telegram;    $option = [        [            $telegram->buildInlineKeyBoardButton('ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹ ÑĞ·Ñ‹Ğº', $url = '', $callback_data = 'ru'),            $telegram->buildInlineKeyBoardButton('ğŸ‡ºğŸ‡¿ O\'zbek tili', $url = '', $callback_data = 'uz'),        ],    ];    $keyb = $telegram->buildInlineKeyBoard($option);    $content = ['chat_id' => $telegram->ChatID(), 'reply_markup' => $keyb, 'text' => "Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ÑĞ·Ñ‹Ğº:"];    $telegram->sendMessage($content);}function sendDistricts(){    global $districts, $user;    $mdistricts = $districts->getAllDistricts();    for ($i = 0; $i < count($mdistricts); $i++) {        $mdistricts[$i] = "ğŸ“ " . $mdistricts[$i];    }    msendKeyBoard($mdistricts, $user->getText('text_choose_district')." ğŸ‘‡ğŸ»");}